"use strict";(self.webpackChunktatasteel=self.webpackChunktatasteel||[]).push([[180],{8180:(T,g,s)=>{s.r(g),s.d(g,{PanelViolationsModule:()=>w});var d=s(9569),h=s(9174),u=s(529),m=s(9646),v=s(4327),e=s(4650),_=s(7445),f=s(1305),b=s(2216),p=s(6895),x=s(2953);function C(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div",7)(1,"h5",8),e.\u0275\u0275text(2,"IP Address"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"h4"),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(t.currentData.ip_address?t.currentData.ip_address:"--")}}function y(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",30),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.imageCarousal(i))}),e.\u0275\u0275text(1,"\xa0\xa0 "),e.\u0275\u0275element(2,"fa-icon",31),e.\u0275\u0275text(3," More Images \xa0\xa0"),e.\u0275\u0275elementEnd()}}function P(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div",38),e.\u0275\u0275element(1,"input",39),e.\u0275\u0275elementStart(2,"label",40),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()()),2&o){const t=e.\u0275\u0275nextContext().$implicit,n=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("checked","Vest"===t?"arc_jacket"==n[t]:n[t]),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t)}}function V(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,P,4,2,"div",37),e.\u0275\u0275elementEnd()),2&o){const t=l.$implicit,n=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Helmet"===t?"none"!==n[t]&&!1===n[t]:"Vest"===t&&"no_ppe"===n[t])}}function S(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div",33)(1,"div")(2,"div",34),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"ul",35)(5,"li"),e.\u0275\u0275template(6,V,2,1,"div",36),e.\u0275\u0275elementEnd()()()()),2&o){const t=l.$implicit,n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",t.violation_count,""),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",n.objectKeys(t))}}function E(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,S,7,2,"div",32),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.object_data)}}function I(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",41)(1,"div",42)(2,"input",43),e.\u0275\u0275listener("change",function(i){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.VerifyTrueViol(i,a))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"label",44),e.\u0275\u0275text(4,"Yes "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",45)(6,"input",46),e.\u0275\u0275listener("change",function(i){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.VerifyFalseViol(i,a))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"label",47),e.\u0275\u0275text(8,"No "),e.\u0275\u0275elementEnd()()()}2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("value",0)("defaultValue",!0),e.\u0275\u0275advance(4),e.\u0275\u0275property("value",!1)("defaultValue",!1))}function O(o,l){1&o&&(e.\u0275\u0275elementStart(0,"div",48),e.\u0275\u0275text(1,"Verified"),e.\u0275\u0275elementEnd())}function k(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tr",14)(1,"td"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"td")(4,"img",22),e.\u0275\u0275listener("click",function(){const a=e.\u0275\u0275restoreView(t).$implicit,r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.imageCarousal(a))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"br"),e.\u0275\u0275template(6,y,4,0,"button",23),e.\u0275\u0275text(7," \xa0"),e.\u0275\u0275elementStart(8,"button",24),e.\u0275\u0275listener("click",function(){const a=e.\u0275\u0275restoreView(t).$implicit,r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.downloadImage(r.API+"/image/"+a.imagename))}),e.\u0275\u0275text(9," Download Image "),e.\u0275\u0275element(10,"fa-icon",25),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"td")(12,"h4"),e.\u0275\u0275text(13),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(14,E,2,1,"div",26),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"td"),e.\u0275\u0275text(16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"td"),e.\u0275\u0275text(18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"td",27),e.\u0275\u0275template(20,I,9,4,"div",28),e.\u0275\u0275template(21,O,2,0,"ng-template",null,29,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()}if(2&o){const t=l.$implicit,n=e.\u0275\u0275reference(22),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.SNo),e.\u0275\u0275advance(2),e.\u0275\u0275property("src",i.API+"/image/"+t.imagename[0],e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.imagename.length>1),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(t.analyticstype),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","PPE"===t.analyticstype||"RA"===t.analyticstype),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.camera_name?t.camera_name:"null"," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.timestamp," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.violation_verificaton_status)("ngIfElse",n)}}const M=[{path:"",component:(()=>{class o{constructor(t,n,i,a,r){this.server=t,this.activatedRoute=n,this.http=i,this._lightbox=a,this._lightBoxConfig=r,this.violationData=(0,m.of)([]),this.total=(0,m.of)(0),this.page=1,this.pageSize=10,this.tempData=[],this.images=[],this.currentData=null,this.objectKeys=Object.keys,this.activatedRoute.queryParams.subscribe(c=>{this.currentData=c,console.log(c);var D={id:c.id,panel_no:c.panel,imagename:c.imageName};this.currentPanel=c.panel,this.area=c.area,this.department=c.department,this.panel=D}),this.API=this.server.IP}ngOnInit(){this.GetPPEViolations(this.panel)}imageCarousal(t){this.images=[],t.imagename.forEach((n,i)=>{console.log(n),this.images[i]={src:this.API+"/image/"+n,thumb:this.API+"/image/"+n,caption:n}}),this.open(0),console.log(this.images)}open(t){console.log("opening lightbox"),this._lightbox.open(this.images,t)}downloadImage(t){const n=t;new u.WM({responseType:"blob"}),console.log(n);const a=n.substr(n.lastIndexOf("/")+1);this.http.get(n,{responseType:"blob"}).subscribe(r=>{console.log("image url data",r),(0,v.saveAs)(r,a)},r=>{console.log("error",r)})}Back(){window.close()}GetPPEViolations(t){var n=document.getElementById("dataTable");n.classList.add("loading"),this.server.GetRiRoViolationData(t).subscribe(i=>{console.log(i),n.classList.remove("loading"),!0===i.success?(this.tempData=i.message,this.sliceVD()):(n.classList.remove("loading"),this.server.notification(i.message))},i=>{n.classList.remove("loading"),this.server.notification("Error While fetching the Data","Retry")})}SelectViol(t,n){this.editViol=t}VerifyTrueViol(t,n){this.editViol=n,this.server.VerifyViolation(this.editViol._id.$oid,!0).subscribe(i=>{console.log(i),this.server.notification(i.message),i.success&&this.server.GetRiRoViolationData(this.panel).subscribe(a=>{console.log(a),!0===a.success&&(this.tempData=a.message,this.sliceVD())})},i=>{this.server.notification("Error while the  Process","Retry")})}VerifyFalseViol(t,n){this.editViol=n,this.server.VerifyViolation(this.editViol._id.$oid,!1).subscribe(i=>{console.log(i),this.server.notification(i.message),i.success&&this.server.GetRiRoViolationData(this.panel).subscribe(a=>{console.log(a),!0===a.success?(this.tempData=a.message,this.sliceVD()):this.server.notification(a.message)})},i=>{this.server.notification("Error while the  Process","Retry")})}sliceVD(){this.total=(0,m.of)(this.tempData.slice((this.page-1)*this.pageSize,(this.page-1)*this.pageSize+this.pageSize).length),this.total=(0,m.of)(this.tempData.length),this.violationData=(0,m.of)(this.tempData.map((t,n)=>({SNo:n+1,...t})).slice((this.page-1)*this.pageSize,(this.page-1)*this.pageSize+this.pageSize))}}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(_.N),e.\u0275\u0275directiveInject(d.gz),e.\u0275\u0275directiveInject(u.eN),e.\u0275\u0275directiveInject(f.ey),e.\u0275\u0275directiveInject(f.xm))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-panel-violations"]],decls:61,vars:12,consts:[[1,"dashboard-content"],[1,"page-header","mb-5"],[1,"row","mb-3"],[1,""],[1,"btn","primary","float-end",3,"click"],["id","violationCount",1,"row"],[1,"col-3"],[1,"card","analytics","card-body"],[1,"text-muted"],["class","card analytics card-body",4,"ngIf"],[1,"row"],[1,"col-12"],["id","dataTable",1,"card"],[1,"table","table-bordered",2,"width","100%","overflow","auto"],[2,"text-align","center"],["scope","col"],["icon","image",1,"font-custome","me-1"],["icon","camera-retro",1,"font-custome","me-1"],["icon","clock",1,"font-custome","me-1"],["style","text-align: center;",4,"ngFor","ngForOf"],[1,"d-flex","mx-auto","justify-content-center","p-1"],[2,"width","95vw","overflow-x","auto",3,"collectionSize","page","pageSize","pageChange"],[1,"image",3,"src","click"],["class","btn mt-2",3,"click",4,"ngIf"],[1,"btn","btn-sm","default","text-white","mt-2",3,"click"],["icon","download",1,"ms-1","me-1",2,"cursor","pointer"],[4,"ngIf"],[2,"width","3rem"],["id","verify",4,"ngIf","ngIfElse"],["verified",""],[1,"btn","mt-2",3,"click"],["icon","images",1,"mr-1"],["class","border-bottom",4,"ngFor","ngForOf"],[1,"border-bottom"],[1,"mb-3"],[1,"list-unstyled"],[4,"ngFor","ngForOf"],["class","items",4,"ngIf"],[1,"items"],["id","item1","type","checkbox",3,"checked"],["for","item1"],["id","verify"],["id","right",1,"form-check","form-check-inline"],["type","radio","id","yes",1,"form-check-input",3,"value","defaultValue","change"],["for","yes",1,"form-check-label","text-muted"],["id","wrong",1,"form-check","form-check-inline"],["type","radio","id","no",1,"form-check-input",3,"value","defaultValue","change"],["for","no",1,"form-check-label","text-muted"],[1,"success-badge"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"h3"),e.\u0275\u0275text(3,"PPE violations"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"div",2)(5,"div",3)(6,"button",4),e.\u0275\u0275listener("click",function(){return n.Back()}),e.\u0275\u0275text(7,"Back"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(8,"div",5)(9,"div",6)(10,"div",7)(11,"h5",8),e.\u0275\u0275text(12,"Panel"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"h4"),e.\u0275\u0275text(14),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(15,"div",6),e.\u0275\u0275template(16,C,5,1,"div",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"div",6)(18,"div",7)(19,"h5",8),e.\u0275\u0275text(20,"department"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"h4"),e.\u0275\u0275text(22),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(23,"div",6)(24,"div",7)(25,"h5",8),e.\u0275\u0275text(26,"Sub Area"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"h4"),e.\u0275\u0275text(28),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(29,"div",10)(30,"div",11)(31,"div",12)(32,"table",13)(33,"thead",14)(34,"tr")(35,"th",15)(36,"b"),e.\u0275\u0275text(37,"S No"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(38,"th",15)(39,"b"),e.\u0275\u0275element(40,"fa-icon",16),e.\u0275\u0275text(41,"Image "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(42,"th",15)(43,"b"),e.\u0275\u0275text(44," Violation Type "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(45,"th",15)(46,"b"),e.\u0275\u0275element(47,"fa-icon",17),e.\u0275\u0275text(48,"Camera Name "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(49,"th",15)(50,"b"),e.\u0275\u0275element(51,"fa-icon",18),e.\u0275\u0275text(52,"Detected Time "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(53,"th"),e.\u0275\u0275text(54,"Is Valid?"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(55,"tbody"),e.\u0275\u0275template(56,k,23,9,"tr",19),e.\u0275\u0275pipe(57,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(58,"div",20)(59,"ngb-pagination",21),e.\u0275\u0275listener("pageChange",function(a){return n.page=a})("pageChange",function(){return n.sliceVD()}),e.\u0275\u0275pipe(60,"async"),e.\u0275\u0275elementEnd()()()()()()),2&t&&(e.\u0275\u0275advance(14),e.\u0275\u0275textInterpolate(n.currentPanel?n.currentPanel:"--"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",null!=n.currentData),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(n.department?n.department:"--"),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(n.area?n.area:"--"),e.\u0275\u0275advance(28),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(57,8,n.violationData)),e.\u0275\u0275advance(3),e.\u0275\u0275property("collectionSize",e.\u0275\u0275pipeBind1(60,10,n.total))("page",n.page)("pageSize",n.pageSize))},dependencies:[b.BN,p.NgForOf,p.NgIf,x.N9,p.AsyncPipe],styles:['.image[_ngcontent-%COMP%]{margin-left:0;margin-right:0;height:174px;width:330px;border-radius:5px!important;object-fit:contain}input[type=checkbox][_ngcontent-%COMP%]{display:block;height:30px;margin:0 0 -53px -9999px;order:4;top:5px;outline:none;counter-increment:undone-items}input[_ngcontent-%COMP%]:checked{pointer-events:none;order:2;counter-increment:done-items}label[_ngcontent-%COMP%]{pointer-events:none;display:block;position:relative;padding:15px 10px 15px 0;border-top:1px dashed #fff;order:4;cursor:pointer;animation:undone .5s}label[_ngcontent-%COMP%]:before{content:"\\f10c";display:block;position:absolute;top:15px;margin-right:0}input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{order:2;animation:done .5s}input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:before{margin-left:15px;color:#cc1d1d;content:"\\2713"}input[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]:before{margin-left:15px;color:#cc1d1d;content:"\\2716"}ngb-pagination[_ngcontent-%COMP%]     ul>li:not(.active)>a{background-color:#f8f8f8!important;border-radius:5px!important;box-shadow:none}ngb-pagination[_ngcontent-%COMP%]     ul>li.active>a{background-color:#2d5686!important;border-radius:5px!important;box-shadow:none}ngb-pagination[_ngcontent-%COMP%]     ul>li:not(.active)>a{background-color:#f8f8f8!important;border-radius:5px!important;color:var(--label-color)!important;box-shadow:none}ngb-pagination[_ngcontent-%COMP%]     ul>li.active>a{background-color:var(--label-color)!important;border-radius:5px!important;border:1px solid var(--label-color)!important;box-shadow:none}#violationCount[_ngcontent-%COMP%]   .card.card-body[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}input[type=radio][_ngcontent-%COMP%]{display:block;height:30px;margin:0 0 -53px -9999px;order:4;outline:none;position:relative;counter-increment:undone-items}#verify[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{pointer-events:all;display:block;position:relative;border-top:1px dashed #fff;order:4;cursor:pointer;animation:undone .5s;margin-left:10px!important}#verify[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:before{content:"\\25ef";display:block;position:absolute;margin-right:10px!important;right:2rem;font-weight:500;color:#c9c9c9}#verify[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{order:2;animation:done .5s}#verify[_ngcontent-%COMP%]   #wrong[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:before{font-size:larger;font-family:500;color:#cc1d1d;content:"\\2713"}#verify[_ngcontent-%COMP%]   #right[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:before{font-size:larger;font-family:700;color:#1dc41d;content:"\\2713"}']}),o})()}];let w=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({imports:[h.A,d.Bz.forChild(M),d.Bz]}),o})()}}]);